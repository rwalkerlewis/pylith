[pylithapp.metadata]
keywords = [thermoelasticity, full-scale test, 2D]
features = [
    Quasistatic simulation,
    pylith.materials.Thermoelasticity,
    pylith.materials.IsotropicLinearThermoelasticity,
    pylith.problems.SolnDispTemp,
    field split preconditioner
    ]

# ----------------------------------------------------------------------
# journal
# ----------------------------------------------------------------------
[pylithapp.journal.info]
timedependent = 1
solution = 1
meshiopetsc = 1
meshioascii = 1

[pylithapp.journal.debug]
timedependent = 0
solution = 0
isotropiclinearthermoelasticity = 0
thermoelasticity = 0
dirichlettimedependent = 0

# ----------------------------------------------------------------------
# mesh
# ----------------------------------------------------------------------
[pylithapp.mesh_generator]
reader = pylith.meshio.MeshIOAscii
reader.coordsys.space_dim = 2

# ----------------------------------------------------------------------
# problem
# ----------------------------------------------------------------------
[pylithapp.problem]
solution = pylith.problems.SolnDispTemp

[pylithapp.problem.defaults]
quadrature_order = 1

[pylithapp.problem]
# Use zero initial guess for temperature
initial_dt = 1.0*s
start_time = 0.0*s
end_time = 0.0*s

[pylithapp.problem.solution.subfields.displacement]
basis_order = 1

[pylithapp.problem.solution.subfields.temperature]
basis_order = 1

# ----------------------------------------------------------------------
# materials
# ----------------------------------------------------------------------
[pylithapp.problem]
materials = [thermoelastic_material]
materials.thermoelastic_material = pylith.materials.Thermoelasticity

[pylithapp.problem.materials.thermoelastic_material]
description = Thermoelastic material
label_value = 24

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Thermoelastic material properties
db_auxiliary_field.values = [density, vs, vp, specific_heat, thermal_conductivity, reference_temperature, thermal_expansion_coefficient]
db_auxiliary_field.data = [2500.0*kg/m**3, 3000.0*m/s, 5196.0*m/s, 1000.0*J/(kg*K), 3.0*W/(m*K), 300.0*K, 1.0e-5*1/K]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.specific_heat.basis_order = 0
auxiliary_subfields.thermal_conductivity.basis_order = 0
auxiliary_subfields.reference_temperature.basis_order = 0
auxiliary_subfields.thermal_expansion_coefficient.basis_order = 0
auxiliary_subfields.shear_modulus.basis_order = 0
auxiliary_subfields.bulk_modulus.basis_order = 0

bulk_rheology = pylith.materials.IsotropicLinearThermoelasticity

# ----------------------------------------------------------------------
# boundary conditions
# ----------------------------------------------------------------------
[pylithapp.problem]
bc = [bc_xneg, bc_xpos]
bc.bc_xneg = pylith.bc.DirichletTimeDependent
bc.bc_xpos = pylith.bc.DirichletTimeDependent

# Left boundary: fixed displacement, prescribed temperature
[pylithapp.problem.bc.bc_xneg]
label = boundary_xneg
label_value = 1
constrained_dof = [0, 1]
field = displacement

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Left boundary displacement BC
db_auxiliary_field.values = [initial_amplitude_x, initial_amplitude_y]
db_auxiliary_field.data = [0.0*m, 0.0*m]

[pylithapp.problem.bc.bc_xpos]
label = boundary_xpos
label_value = 1
constrained_dof = [0]
field = temperature

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Right boundary temperature BC
db_auxiliary_field.values = [initial_amplitude]
db_auxiliary_field.data = [300.0*K]

# Add temperature BC on left boundary
[pylithapp.problem]
bc = [bc_xneg, bc_xpos, bc_temp_xneg]
bc.bc_temp_xneg = pylith.bc.DirichletTimeDependent

[pylithapp.problem.bc.bc_temp_xneg]
label = boundary_xneg
label_value = 1
constrained_dof = [0]
field = temperature

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Left boundary temperature BC
db_auxiliary_field.values = [initial_amplitude]
db_auxiliary_field.data = [350.0*K]

# ----------------------------------------------------------------------
# petsc
# ----------------------------------------------------------------------
[pylithapp.petsc]
ts_type = beuler

pc_type = fieldsplit
pc_fieldsplit_type = additive

fieldsplit_displacement_pc_type = lu
fieldsplit_temperature_pc_type = lu

ksp_rtol = 1.0e-10
ksp_atol = 1.0e-15
ksp_max_it = 100
ksp_gmres_restart = 50
ksp_error_if_not_converged = true

snes_rtol = 1.0e-10
snes_atol = 1.0e-12
snes_error_if_not_converged = true

# End of file
