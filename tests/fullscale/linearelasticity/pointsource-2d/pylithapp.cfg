# =================================================================================================
# This code is part of PyLith, developed through the Computational Infrastructure
# for Geodynamics (https://github.com/geodynamics/pylith).
#
# Copyright (c) 2010-2025, University of California, Davis and the PyLith Development Team.
# All rights reserved.
#
# See https://mit-license.org/ and LICENSE.md and for license information. 
# =================================================================================================
#
# Base configuration for point source tests.
# All tests in this directory use this configuration.

[pylithapp.metadata]
base = [pylithapp.cfg]
description = Base configuration for point source tests in 2D.
authors = [PyLith Development Team]
keywords = [point source, moment tensor, elastodynamics]
version = 1.0.0

[pylithapp]
dump_parameters.filename = output/pylithapp-parameters.json
problem.progress_monitor.filename = output/progress.txt

# ----------------------------------------------------------------------
# journal
# ----------------------------------------------------------------------
[pylithapp.journal.info]
timedependent = 1
solution = 1
meshiopetsc = 1

# ----------------------------------------------------------------------
# problem
# ----------------------------------------------------------------------
[pylithapp.problem]
normalizer = spatialdata.units.NondimElasticDynamic
normalizer.shear_wave_speed = 1.0*km/s
normalizer.length_scale = 1.0*km
normalizer.relaxation_time = 1.0*s

formulation = pylith.problems.Formulation.DYNAMIC

# Time stepping
initial_dt = 0.01*s
start_time = 0*s
end_time = 2.0*s

defaults.quadrature_order = 1

[pylithapp.problem.solution.subfields]
displacement.basis_order = 1
velocity.basis_order = 1

# ----------------------------------------------------------------------
# materials
# ----------------------------------------------------------------------
[pylithapp.problem]
materials = [elastic]

[pylithapp.problem.materials.elastic]
description = Elastic material
label_value = 1

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Elastic properties
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500.0*kg/m**3, 1.0*km/s, 1.732*km/s]

observers.observer.data_fields = [displacement, velocity]
observers.observer.writer.filename = output/{name}-elastic.h5

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.bulk_modulus.basis_order = 0
auxiliary_subfields.shear_modulus.basis_order = 0

# ----------------------------------------------------------------------
# boundary conditions
# ----------------------------------------------------------------------
[pylithapp.problem]
bc = [bc_xneg, bc_xpos, bc_yneg, bc_ypos]
bc.bc_xneg = pylith.bc.AbsorbingDampers
bc.bc_xpos = pylith.bc.AbsorbingDampers
bc.bc_yneg = pylith.bc.AbsorbingDampers
bc.bc_ypos = pylith.bc.AbsorbingDampers

[pylithapp.problem.bc.bc_xneg]
label = boundary_xneg
label_value = 10

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Absorbing BC properties on -x boundary
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500.0*kg/m**3, 1.0*km/s, 1.732*km/s]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.vs.basis_order = 0
auxiliary_subfields.vp.basis_order = 0

[pylithapp.problem.bc.bc_xpos]
label = boundary_xpos
label_value = 11

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Absorbing BC properties on +x boundary
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500.0*kg/m**3, 1.0*km/s, 1.732*km/s]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.vs.basis_order = 0
auxiliary_subfields.vp.basis_order = 0

[pylithapp.problem.bc.bc_yneg]
label = boundary_yneg
label_value = 12

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Absorbing BC properties on -y boundary
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500.0*kg/m**3, 1.0*km/s, 1.732*km/s]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.vs.basis_order = 0
auxiliary_subfields.vp.basis_order = 0

[pylithapp.problem.bc.bc_ypos]
label = boundary_ypos
label_value = 13

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Absorbing BC properties on +y boundary
db_auxiliary_field.values = [density, vs, vp]
db_auxiliary_field.data = [2500.0*kg/m**3, 1.0*km/s, 1.732*km/s]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.vs.basis_order = 0
auxiliary_subfields.vp.basis_order = 0

# ----------------------------------------------------------------------
# output
# ----------------------------------------------------------------------
[pylithapp.problem.solution.observers.observer]
writer.filename = output/{name}-domain.h5


# End of file
