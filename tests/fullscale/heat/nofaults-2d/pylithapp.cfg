[pylithapp.metadata]
description = Base configuration for 2D heat conduction tests
authors = [PyLith Development Team]
keywords = [full-scale test, 2D, heat conduction]
version = 1.0.0
pylith_version = [>=3.0, <6.0]

features = [
    Quasistatic problem,
    pylith.materials.Heat,
    pylith.meshio.MeshIOAscii,
    pylith.problems.TimeDependent,
    pylith.problems.SolnTemp,
    pylith.bc.DirichletTimeDependent,
    pylith.meshio.DataWriterHDF5,
    spatialdata.spatialdb.UniformDB
    ]

[pylithapp.launcher] # WARNING: THIS IS NOT PORTABLE
command = mpiexec -np ${nodes}

# ----------------------------------------------------------------------
# journal
# ----------------------------------------------------------------------
[pylithapp.journal.info]
#timedependent = 1
#solution = 1
#petsc = 1

# ----------------------------------------------------------------------
# mesh_generator
# ----------------------------------------------------------------------
[pylithapp.mesh_generator]
reader = pylith.meshio.MeshIOAscii

[pylithapp.mesh_generator.reader]
coordsys.space_dim = 2

# ----------------------------------------------------------------------
# problem
# ----------------------------------------------------------------------
[pylithapp.problem]
defaults.quadrature_order = 2

# Use nonlinear solver to ensure residual and Jacobian are consistent.
solver = nonlinear

solution = pylith.problems.SolnTemp

[pylithapp.timedependent]
start_time = 0.0*s
initial_dt = 1.0*s
end_time = 0.0*s

# No scaling for thermal problems (use SI units directly)

[pylithapp.problem.solution.subfields]
temperature.basis_order = 1

[pylithapp.problem]
solution_observers = [domain]

# ----------------------------------------------------------------------
# materials
# ----------------------------------------------------------------------
[pylithapp.problem]
materials = [heat_material]
materials.heat_material = pylith.materials.Heat

[pylithapp.problem.materials.heat_material]
label_value = 24

db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Heat conduction properties
db_auxiliary_field.values = [density, specific_heat, thermal_conductivity]
db_auxiliary_field.data   = [2500*kg/m**3, 900*J/(kg*K), 3.0*W/(m*K)]

observers.observer.data_fields = [temperature]

auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.specific_heat.basis_order = 0
auxiliary_subfields.thermal_conductivity.basis_order = 0

# ----------------------------------------------------------------------
# boundary conditions
# ----------------------------------------------------------------------
[pylithapp.problem]
bc = [bc_xneg, bc_xpos]

bc.bc_xneg = pylith.bc.DirichletTimeDependent
bc.bc_xpos = pylith.bc.DirichletTimeDependent

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.bc_xneg]
label = boundary_xneg
label_value = 1
field = temperature

constrained_dof = [0]
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Dirichlet BC on -x boundary
db_auxiliary_field.values = [initial_amplitude]
db_auxiliary_field.data = [300.0*K]

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.bc_xpos]
label = boundary_xpos
label_value = 1
field = temperature

constrained_dof = [0]
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.description = Dirichlet BC on +x boundary
db_auxiliary_field.values = [initial_amplitude]
db_auxiliary_field.data = [400.0*K]

# ----------------------------------------------------------------------
# PETSc
# ----------------------------------------------------------------------
[pylithapp.problem.petsc_defaults]
solver = True
testing = True
monitors = False

# End of file
