# ----------------------------------------------------------------------
# problem
# ----------------------------------------------------------------------
[pylithapp.problem]
initial_dt = 1.0*s
start_time = 0.0*s
end_time = 5.0*s

[pylithapp.problem.normalizer]
length_scale = 1.0*m
relaxation_time = 1.0*s

# ----------------------------------------------------------------------
# solution
# ----------------------------------------------------------------------
[pylithapp.problem]
solution = pylith.problems.SolnDispPresTracStrain

[pylithapp.problem.solution.subfields.displacement]
basis_order = 1

[pylithapp.problem.solution.subfields.pressure]
basis_order = 1

[pylithapp.problem.solution.subfields.trace_strain]
basis_order = 1

# ----------------------------------------------------------------------
# materials
# ----------------------------------------------------------------------
[pylithapp.problem.materials]
poroelastic_xneg = pylith.materials.Poroelasticity
poroelastic_xneg.bulk_rheology = pylith.materials.IsotropicLinearPoroelasticity

poroelastic_xpos = pylith.materials.Poroelasticity
poroelastic_xpos.bulk_rheology = pylith.materials.IsotropicLinearPoroelasticity

[pylithapp.problem.materials.poroelastic_xneg]
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.label = Poroelastic properties
db_auxiliary_field.values = [porosity,      density, fluid_density, fluid_viscosity, shear_modulus, bulk_modulus, biot_coefficient, isotropic_permeability, fluid_bulk_modulus]
db_auxiliary_field.data   = [    0.19, 2500*kg/m**3,  1000*kg/m**3,      0.001*Pa*s,        6e9*Pa,    3.6e10*Pa,            0.778,          1.90e-13*m**2,             2e9*Pa]

auxiliary_subfields.porosity.basis_order = 0
auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.fluid_density.basis_order = 0
auxiliary_subfields.fluid_viscosity.basis_order = 0

bulk_rheology.auxiliary_subfields.bulk_modulus.basis_order = 0
bulk_rheology.auxiliary_subfields.shear_modulus.basis_order = 0
bulk_rheology.auxiliary_subfields.biot_coefficient.basis_order = 0
bulk_rheology.auxiliary_subfields.isotropic_permeability.basis_order = 0
bulk_rheology.auxiliary_subfields.fluid_bulk_modulus.basis_order = 0

derived_subfields.cauchy_strain.basis_order = 1
derived_subfields.cauchy_stress.basis_order = 1

[pylithapp.problem.materials.poroelastic_xpos]
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.label = Poroelastic properties
db_auxiliary_field.values = [porosity,      density, fluid_density, fluid_viscosity, shear_modulus, bulk_modulus, biot_coefficient, isotropic_permeability, fluid_bulk_modulus]
db_auxiliary_field.data   = [    0.19, 2500*kg/m**3,  1000*kg/m**3,      0.001*Pa*s,        6e9*Pa,    3.6e10*Pa,            0.778,          1.90e-13*m**2,             2e9*Pa]

auxiliary_subfields.porosity.basis_order = 0
auxiliary_subfields.density.basis_order = 0
auxiliary_subfields.fluid_density.basis_order = 0
auxiliary_subfields.fluid_viscosity.basis_order = 0

bulk_rheology.auxiliary_subfields.bulk_modulus.basis_order = 0
bulk_rheology.auxiliary_subfields.shear_modulus.basis_order = 0
bulk_rheology.auxiliary_subfields.biot_coefficient.basis_order = 0
bulk_rheology.auxiliary_subfields.isotropic_permeability.basis_order = 0
bulk_rheology.auxiliary_subfields.fluid_bulk_modulus.basis_order = 0

derived_subfields.cauchy_strain.basis_order = 1
derived_subfields.cauchy_stress.basis_order = 1

# ----------------------------------------------------------------------
# boundary conditions
# ----------------------------------------------------------------------
[pylithapp.problem]
bc = [x_neg,x_pos,y_neg,y_pos_neu,y_pos_dir]

bc.x_pos = pylith.bc.DirichletTimeDependent
bc.x_neg = pylith.bc.DirichletTimeDependent
bc.y_neg = pylith.bc.DirichletTimeDependent
bc.y_pos_neu = pylith.bc.NeumannTimeDependent
bc.y_pos_dir = pylith.bc.DirichletTimeDependent
# ------------------------------------------------------------------------------
[pylithapp.problem.bc.x_pos]
# Set Ux=+2.0*m on the +x boundary.
constrained_dof = [0]
label = edge_xpos
field = displacement
# The spatial database must contain both components even though we do
# not constrain the y component.
db_auxiliary_field = pylith.bc.ZeroDB
db_auxiliary_field.label = Dirichlet BC on +x boundary

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.x_neg]
constrained_dof = [0]
label = edge_xneg
field = displacement
db_auxiliary_field = pylith.bc.ZeroDB
db_auxiliary_field.label = Dirichlet BC on -x boundary

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.y_neg]
constrained_dof = [1]
label = edge_yneg
field = displacement
db_auxiliary_field = pylith.bc.ZeroDB
db_auxiliary_field.label = Dirichlet BC on -y boundary

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.y_pos_neu]
#constrained_dof = [0]
label = edge_ypos
field = displacement
db_auxiliary_field = spatialdata.spatialdb.UniformDB
db_auxiliary_field.label = Neumann BC +y edge

db_auxiliary_field.values = [initial_amplitude_tangential, initial_amplitude_normal]
db_auxiliary_field.data = [0.0*Pa, -1000.0*Pa]

auxiliary_subfields.initial_amplitude.basis_order = 0

# ------------------------------------------------------------------------------
[pylithapp.problem.bc.y_pos_dir]
constrained_dof = [0]
label = edge_ypos
field = pressure
db_auxiliary_field = pylith.bc.ZeroDB
db_auxiliary_field.label = Dirichlet BC for pressure on +y edge

auxiliary_subfields.initial_amplitude.basis_order = 0

# ----------------------------------------------------------------------
# PETSc
# ----------------------------------------------------------------------

[pylithapp.petsc]
start_in_debugger = True

# End of file
